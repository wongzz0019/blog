# 网络协议

## TCP/IP协议

**TCP/IP 协议总共有四层**

- 第一层叫 **链接层**：发送原始数据包
- 第二层叫 **网络层**
- 第三层叫 **传输层**：TCP 协议工作的层次，另外还有UDP
- 第四层叫 **应用层**



### 连接（三次握手）

![image-20220331233105948](C:\Users\Bosco\AppData\Roaming\Typora\typora-user-images\image-20220331233105948.png)

#### 为什么需要三次握手，二次四次不行吗？

因为三次握手能确保双方可以正常通信，两次不够建立连接，四次显得多余。

第一次握手：

- 客户端啥都不确认；
- 服务端确认了对方发送正常，自己接收正常

第二次握手：

- 客户端确认自己发送、接收正常
- 服务端确认对方发送正常，自己接收正常

第三次握手：

- 客户端确认了自己发送、接收正常，对方发送、接收正常
- 服务端确认了自己发送、接收正常，对方发送、接收正常

 就比如：吃宵夜一个人紧紧盯着你，

你：你瞅啥？ 

人：瞅你咋地。

你：你想干架啊。

三句话完了，怒气一升，能量满满。两人就打起来了。如果少一句或多一句话都不行了。

### 断开连接（四次挥手）

![image-20220331233206941](C:\Users\Bosco\AppData\Roaming\Typora\typora-user-images\image-20220331233206941.png)

第一次挥手：

- 客户端发起关闭连接的请求给服务端；

第二次挥手：

- 服务端收到关闭请求的时候可能这个时候数据还没发送完，所以服务端会先回复一个确认报文，表示自己知道客户端想要关闭连接了，但是因为数据还没传输完，所以还需要等待；

第三次挥手：

- 当数据传输完了，服务端会主动发送一个 FIN 报文，告诉客户端，表示数据已经发送完了，服务端这边准备关闭连接了。

第四次挥手：

- 当客户端收到服务端的 FIN 报文过后，会回复一个 ACK 报文，告诉服务端自己知道了，再等待一会就关闭连接。



### 为什么握手要三次，挥手却要四次呢？

那是因为握手的时候并没有数据传输，但是挥手的时候有数据在传输



### TCP和UDP的区别

1. TCP是面向连接的，可靠的，而UDP是无连接的，不可靠的。
2. TCP连接只能一对一通信；UDP支持多种通信方式。
3. TCP面向字节流传输，以字节为单位。用于文件传输、邮件收发；
4. UDP是面向报文的，直接发送整个数据包。一般用于即时通信，如语音、视频等

###  TCP如何保证可靠

- 三次握手和四次挥手
- 确认应答与序列号
  - 接收方收到数据，会反馈给发送方，在应答报文中会带着序列号。
- 超时重传
  - 在规定时间内发送方没收到应答，会重发报文。



## 在浏览器中输入 url 地址 ->> 显示主页的过程(面试常客)

总体来说分为以下==6==个过程:

1. DNS 解析
   - 解析url地址，查询浏览器DNS缓存、系统DNS缓存......
2. TCP 连接
   - TCP三次握手
3. 发送 HTTP 请求
   - 发送请求报文（请求行，请求报文头，请求正文）
4. 服务器处理请求并返回 HTTP 报文
   - HTTP响应报文（状态码，响应报文头，响应报文）
5. 浏览器解析渲染页面
6. 连接结束
   - TCP四次挥手

## HTTP

### 常见状态码

- **200：成功处理请求（OK），完成整个处理过程**
- 204：成功处理请求，没有返回内容
- **301：永久性重定向**
- **302：临时性重定向**
- 304：
- **400：服务器不理解请求的语法（请求语法错误）**
- 401：未授权登录
- **403：服务器拒绝访问**
- **404：服务器未找到请求页面资源（找不到资源）**
- **500：服务器内部错误**
- **503：服务不可用**
- **504：访问超时**

### 常见请求方法

- GET：请求页面信息，获得数据
- POST： 提交表单或上传文件。POST请求可能会导致新资源的建立或已有资源的修改
- PUT：更新服务器资源
- DELETE：删除服务器资源
- OPTIONS：获取服务器可以请求的方法
- HEAD：类似于get请求，只不过获取的是HTTP的头信息

###  GET和POST的区别

1. **参数传递方式**：GET参数通过URL传递，POST放在Request body中。
2. **请求编码**：GET请求只能进行url编码`application/x-www-form-urlencoded`，而POST支持多种编码方式，如 url编码、`application/json`、`multipart/form-data`。
3. **浏览器回退**：GET在浏览器回退时单纯回到页面，而POST会再次提交请求。
4. **浏览器缓存**：GET请求会放入浏览器cache中，而POST不会，除非手动设置。

### cookie、session的作用

- **Cookie 一般用来保存用户信息**
- **Session 通过服务端记录用户的状态**

### cookie 和 session 的区别？

1. 存放位置不同。cookie存放浏览器上，session存放服务器上。
2. 数据大小不同。单个cookie保存的数据不能超过4K，而session没有限制。
3. 数据类型不同。cookie中只能保管ASCII字符串。而session中能够存储任何类型的数据。
4. cookie对客户端是可见的，用户可以通过设置cookie来进行伪装，但session不行。
5. 服务器资源。cookie保管在客户端，不占用服务器资源。session是保管在服务器端的，每个用户都会产生一个session。假如并发访问的用户很多，会产生很多的session，耗费大量的内存。

### HTTP和HTTPS区别

- HTTP是简单、可扩展的、通过明文传输的，端口为80。

- HTTPS在HTTP的基础上增加了加密传输，端口为443

