# 网络协议

## TCP/IP

### 连接（三次握手）

![image-20220331233105948](C:\Users\Bosco\AppData\Roaming\Typora\typora-user-images\image-20220331233105948.png)

#### 为什么需要三次握手，二次四次不行吗？

因为三次握手能确保双方可以正常通信，两次不够建立连接，四次显得多余。

第一次握手：

- 客户端啥都不确认；
- 服务端确认了对方发送正常，自己接收正常

第二次握手：

- 客户端确认自己发送、接收正常
- 服务端确认对方发送正常，自己接收正常

第三次握手：

- 客户端确认了自己发送、接收正常，对方发送、接收正常
- 服务端确认了自己发送、接收正常，对方发送、接收正常

 就比如：吃宵夜一个人紧紧盯着你，

你：你瞅啥？ 

人：瞅你咋地。

你：你想干架啊。

三句话完了，怒气一升，能量满满。两人就打起来了。如果少一句或多一句话都不行了。

### 断开连接（四次挥手）

![image-20220331233206941](C:\Users\Bosco\AppData\Roaming\Typora\typora-user-images\image-20220331233206941.png)

第一次挥手：

- 客户端发起关闭连接的请求给服务端；

第二次挥手：

- 服务端收到关闭请求的时候可能这个时候数据还没发送完，所以服务端会先回复一个确认报文，表示自己知道客户端想要关闭连接了，但是因为数据还没传输完，所以还需要等待；

第三次挥手：

- 当数据传输完了，服务端会主动发送一个 FIN 报文，告诉客户端，表示数据已经发送完了，服务端这边准备关闭连接了。

第四次挥手：

- 当客户端收到服务端的 FIN 报文过后，会回复一个 ACK 报文，告诉服务端自己知道了，再等待一会就关闭连接。



### 为什么握手要三次，挥手却要四次呢？

那是因为握手的时候并没有数据传输，但是挥手的时候有数据在传输



### TCP和UDP的区别

1. TCP是面向连接的，可靠的，而UDP是无连接的，不可靠的。
2. TCP连接只能一对一通信；UDP支持多种通信方式。
3. TCP面向字节流传输，以字节为单位；UDP是面向报文的，直接发送整个数据包。

###  TCP如何保证可靠

- 三次握手和四次挥手
- 确认应答与序列号
  - 接收方收到数据，会反馈给发送方，在应答报文中会带着序列号。
- 超时重传
  - 在规定时间内发送方没收到应答，会重发报文。





## HTTP

