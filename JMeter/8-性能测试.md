# 什么是性能测试

- 使用自动化工具，模拟不同场景，对软件各项性能指标进行测试和评估的过程

# 性能测试的目的是什么

- 评估当前系统能力
- 寻找性能瓶颈，优化性能
- 评估软件是否能够满足未来的需求

# 性能测试策略

## 基准测试

### 什么是基准测试？

- 狭义上讲：就是**单用户测试**。（**单用户循环多次得到的数据**）
- 广义上讲：建立**基准线**，当系统的软硬**件环境发生变化**之后再进行 一次基准测试**以确定变化对性能的影响**

### 基准测试数据的用途？

- 基准测试不会单独存在
- 为多用户并发测试和综合场景测试等提供参考依据
- 为系统/环境配置、系统优化前后的性能提升/下降提供参考指标



## 负载测试

**大量用户同时发送请求**

### 概念

- 通过逐步增加系统负载，确定在**满足系统的性能旨标（如响应时间等）情况下**，找出系统所能够承受的**最大负载量的测试**

### 作用

- 系统**最大负载量**达到**用户要求**时，系统才能正式上线使用

- 例子：

  ![image-20220717142515398](https://raw.githubusercontent.com/wongzz0019/blog/master/JMeter/img/image-20220717142515398.png)



## 稳定性测试

### 概念

- 在服务器**稳定运行（用户正常的业务负载下）**的情况下进行**长时 间测试（1天-1周等)**，并最终保证服务器能满足线上业务需求

### 作用

- 系统**在用户要求的业务负载下**运行达到**规定的时间**时，系统才能

  正式上线使用



## 压力测试

### 概念

- 在强负载下的测试，查看系统在**峰值情况下**是否功能隐患、系统 是否具有良好的**容错能力**和**可恢复能力**

### 测试场景

- **极限负载**情况下的**破坏性压力测试**
- **高负载**下的长时间的**稳定性压力测试**



## 并发测试

**秒杀**

### 概念

- 并发测试（绝对并发）：是指在**极短的时间内**，发送**多个请求**，来验证服务器对并发的处理能力

### 应用场景

- **特定活动场景，如：抢红包、秒杀、抢购等**



## 负载和并发相比

- 负载测试：主要目的是测试高负载情况下，对系统资源的消耗，是否会耗尽的问题（双11活动）
- 并发测试：主要目的是测试极短时间内，并发请求时，系统资源争抢的问题（抢红包、秒杀）



## 总结

![image-20220618111615971](https://raw.githubusercontent.com/wongzz0019/blog/master/JMeter/img/image-20220618111615971.png)



# 性能测试指标

## 响应时间

- 指从客户端发起请求开始，到客户端接收到结果的总时间
- 包括： 服务器处理时间 + 网络传输时间



## 并发数

- 某一时刻**同时**向服务器**发送请求**的用户数



## 吞吐量

### 概念

- **单位时间内**处理的客户端**请求数量**，直接体现软件系统的性能承载能力

### 吞吐量单位

- 从业务角度：业务数/天、访问人数/天、页面访问量/天
- 从网络角度：字节数/小时、字节数/天
- 从技术指标：**每秒查询数（QPS）、每秒事务数（TPS）**

### QPS和TPS关系

- 事务，即业务。**一个事务可以对应一个请求/多个请求**
- 一个事务对应一个请求时：TPS = QPS
- 一个事务对应 n 请求时：QPS = n * TPS

### QPS

- **QPS (Query Per Second)每秒查询数：即控制服务器==每秒==处理的指定==请求==的数量**  

![image-20220618112511156](https://raw.githubusercontent.com/wongzz0019/blog/master/JMeter/img/image-20220618112511156.png)

### TPS

- **TPS （Transactions Per Second）每秒事务数：即控制服务器==每秒==处理的==事务请求==的数量**

![image-20220618112456797](https://raw.githubusercontent.com/wongzz0019/blog/master/JMeter/img/image-20220618112456797.png)



## 点击数

- 所有的**页面元素**（如：图片、链接、框架等）的请求总数**量**
- 注意：点击数是请求数，不是页面上的一次点击

## 错误率

- 指系统在**负载情况**下，失败业务的概率
- 注意：
  - 错误率是性能指标，是高负载下的失败业务的概率
  - 随机bug是功能bug，先解决随机bug才能进行性能测试



## 资源利用率

### 什么是资源利用率

- 系统各种资源的使用情况， **''资源的使用量/总的资源可用量*100 % ”**

### 常见资源指标

- CPU使用率：不高于75%-85%

- 内存（大小）使用率：不高于80%

- 磁盘10 （速率）：不高于90%

- 网络（速率）：不高于80%

  

## 总结

![image-20220618151041721](https://raw.githubusercontent.com/wongzz0019/blog/master/JMeter/img/image-20220618151041721.png)



# 性能测试流程

1. 性能测试需求分析
   - 熟悉需求，获取性能需求指标
2. 性能测试计划及方案
   - 测什么，谁来测、怎么测
3. 性能测试用例设计
   - 用来验证系统是否符合需求
4. 性能测试执行
   - 建立测试环境、编写测试脚本、性能测试监控、执行测试脚本
5. 性能分析和调优
   - 分析性能结果，针对性能bug调优
6. 性能测试报告总结
   - 测试结果总结

# 性能测试的核心

**需求分析、性能测试执行、性能分析调优**
